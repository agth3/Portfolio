<!DOCTYPE html>
<html lang="fr">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Portfolio</title>
        <link rel="stylesheet" href="style.css">
        <!-- <link rel="preload" href="/fonts/myfont.woff2" as="font" type="font/woff2" crossorigin="anonymous"> -->
        <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    </head>

    <body>
        <div class="container-menu-projets">
            <!-- <div class="cadre bord-haut"></div> -->
            <!-- <div class="bloc-accueil"> -->
                    <a class="a-menu logo-menu" href="index.html"></a>
                    <div class="elements-menu-haut" id="nom-menu"><a class="a-menu" href="index.html">Agathe Cotton</a></div>
                    <div class="elements-menu-haut" id="bio-menu"><a class="a-menu highlight-projet" href="bio.html">Bio</a></div>
                    <div class="elements-menu-haut" id="projet-menu"><a class="a-menu highlight-projet" href="mosaique.html">Projets</a></div>
                    <div class="elements-menu-haut" id="lang-menu">FR / ENG</div>
                    <div class="elements-menu-bas highlight-projet" id="tel-menu">06 89 32 68 76</div>
                    <div class="elements-menu-bas" id="mail-menu">agathe.cotton@gmail.com</div>
                    <div class="elements-menu-bas" id="insta-menu"><a class="a-menu highlight-projet" href="https://www.instagram.com/happy_factoryy/?hl=fr" target="_blank">@happy_factoryy</a></div>

                    <button class="fleches-sections-projets" id="fleche-gauche-projets">·ê∏</button>
                    <button class="fleches-sections-projets" id="fleche-droite-projets">·ê≥</button>
        </div>
            <!-- </div> -->
            <!-- <div class="cadre bord-bas"></div>
            <div class="cadre bord-droit"></div>
            <div class="cadre bord-gauche"></div> -->

            <!-- <div class="center-grid"></div> -->
        <div class="container-projets" id="container-projets">                
            <section class="grid-projets" id="projet-OffKey">
                <div class="zone-texte-projets" id="projet-OffKey">
                    <h2 class="titre-projets" id="titre-OffKey">OffKey</h2>
                    <span class="date-projets">2024</span>
                    <span class="description-projets">Identit√© visuelle g√©n√©rative d‚Äôun festival fictif de musique techno bas√©e sur des visuels g√©n√©ratifs programm√©s en p5.js</br>
Esth√©tique glauque, organique et rythmique incarn√©e par le mille-pattes</br>
D√©clinaison sur multiples supports (affiches, r√©seaux sociaux, badges, produits d√©riv√©s...)</span>
                    <span class="outil-projets">Outils mobilis√©s : VS Code - p5.js, Figma, Indesign, Illustrator</span>
                    <span class="contexte-projets">Projet r√©alis√© lors d‚Äôun semestre erasmus √†¬†Politecnico di Milano</br>
avec Luca SCHARRENBACH</span>
                </div>
                <div class="section-slide">
                  <div class="carrousel-container">
                    <div class="scroll-capture"></div> <!-- zone invisible pour capter le scroll -->
                    <div class="carrousel-track">
                      <div class="carrousel-slide"><img src="asset/img/low/20231005_154014.png" alt="Image 1"></div>
                      <div class="carrousel-slide"><img src="asset/img/low/Posterwall.png" alt="Image 2"></div>
                      <div class="carrousel-slide"><img src="asset/img/low/Insta_Post-Feed.png" alt="Image 3"></div>
                      <div class="carrousel-slide"><img src="asset/img/low/20231005_154014.png" alt="Image 1"></div>
                      <div class="carrousel-slide"><img src="asset/img/low/Posterwall.png" alt="Image 2"></div>
                      <div class="carrousel-slide"><img src="asset/img/low/Insta_Post-Feed.png" alt="Image 3"></div>
                    </div>
                    <div class="focus-frame"></div>
                    <div class="scroll-indicator"></div>
                  </div>
                </div>
            </section>

            <section class="grid-projets" id="projet-OffKey-2">
                <div class="zone-texte-projets" id="projet-OffKey-2">
                    <h2 class="titre-projets" id="titre-OffKey-2">OffKey</h2>
                    <span class="date-projets">2024</span>
                    <span class="description-projets">Identit√© visuelle g√©n√©rative d‚Äôun festival fictif de musique techno bas√©e sur des visuels g√©n√©ratifs programm√©s en p5.js</br>
Esth√©tique glauque, organique et rythmique incarn√©e par le mille-pattes</br>
D√©clinaison sur multiples supports (affiches, r√©seaux sociaux, badges, produits d√©riv√©s...)</span>
                    <span class="outil-projets">Outils mobilis√©s : VS Code - p5.js, Figma, Indesign, Illustrator</span>
                    <span class="contexte-projets">Projet r√©alis√© lors d‚Äôun semestre erasmus √†¬†Politecnico di Milano</br>
avec Luca SCHARRENBACH</span>
                </div>
                <div class="section-slide">
                  <div class="carrousel-container">
                    <div class="scroll-capture"></div>
                    <div class="carrousel-track">
                      <div class="carrousel-slide"><img src="asset/img/low/20231005_154014.png" alt="Image 1"></div>
                      <div class="carrousel-slide"><img src="asset/img/low/Posterwall.png" alt="Image 2"></div>
                      <div class="carrousel-slide"><img src="asset/img/low/Insta_Post-Feed.png" alt="Image 3"></div>
                    </div>
                    <div class="focus-frame"></div>
                    <div class="scroll-indicator"></div>
                  </div>
                </div>
            </section>

            <section class="grid-projets" id="projet-OffKey-3">
                <div class="zone-texte-projets" id="projet-OffKey-3">
                    <h2 class="titre-projets" id="titre-OffKey-3">OffKey</h2>
                    <span class="date-projets">2024</span>
                    <span class="description-projets">Identit√© visuelle g√©n√©rative d‚Äôun festival fictif de musique techno bas√©e sur des visuels g√©n√©ratifs programm√©s en p5.js</br>
Esth√©tique glauque, organique et rythmique incarn√©e par le mille-pattes</br>
D√©clinaison sur multiples supports (affiches, r√©seaux sociaux, badges, produits d√©riv√©s...)</span>
                    <span class="outil-projets">Outils mobilis√©s : VS Code - p5.js, Figma, Indesign, Illustrator</span>
                    <span class="contexte-projets">Projet r√©alis√© lors d‚Äôun semestre erasmus √†¬†Politecnico di Milano</br>
avec Luca SCHARRENBACH</span>
                </div>
                <div class="section-slide">
                  <div class="carrousel-container">
                    <div class="scroll-capture"></div>
                    <div class="carrousel-track">
                      <div class="carrousel-slide"><img src="asset/img/low/20231005_154014.png" alt="Image 1"></div>
                      <div class="carrousel-slide"><img src="asset/img/low/Posterwall.png" alt="Image 2"></div>
                      <div class="carrousel-slide"><img src="asset/img/low/Insta_Post-Feed.png" alt="Image 3"></div>
                    </div>
                    <div class="focus-frame"></div>
                    <div class="scroll-indicator"></div>
                  </div>
                </div>
            </section>
        </div>

    </body>

<script>

  //    GESTION DES SLIDES AVEC FLECHES

  const container = document.getElementById("container-projets");
  const btnLeft = document.getElementById("fleche-gauche-projets");
  const btnRight = document.getElementById("fleche-droite-projets");
  const sections = document.querySelectorAll(".grid-projets");

  const sectionWidth = window.innerWidth;
  let currentIndex = 0;

  function updateButtons() {
    btnLeft.disabled = currentIndex === 0;
    btnRight.disabled = currentIndex === sections.length - 1;
  }

  function scrollToIndex(index) {
    const scrollX = index * sectionWidth;
    container.scrollTo({ left: scrollX, behavior: "smooth" });
    currentIndex = index;
    updateButtons();
  }

  btnLeft.addEventListener("click", () => {
    if (currentIndex > 0) {
      scrollToIndex(currentIndex - 1);
    }
  });

  btnRight.addEventListener("click", () => {
    if (currentIndex < sections.length - 1) {
      scrollToIndex(currentIndex + 1);
    }
  });

  // Auto-calcule la section visible au scroll manuel
  container.addEventListener("scroll", () => {
    const newIndex = Math.round(container.scrollLeft / sectionWidth);
    if (newIndex !== currentIndex) {
      currentIndex = newIndex;
      updateButtons();
    }
  });

  window.addEventListener("resize", () => {
  scrollToIndex(currentIndex); // recentre sur la bonne section
});
  // Initialisation
  updateButtons();




//    ADAPTATION DES TEINTES DE HIGHLIGHT PAR SECTION AFFICHEE



  // const sections = document.querySelectorAll(".grid-projets"); d√©j√† d√©clar√©e plus haut

  // Associe chaque ID de section √† une couleur
  const sectionColors = {
    "projet-OffKey": "#e74c3c",    // Rouge
    "projet-OffKey-2": "#3498db",   // Bleu
    "projet-OffKey-3": "#67d92a",  // Vert
    // Ajoute d'autres IDs ici
  };

  // Fonction appel√©e √† chaque changement de visibilit√©
  function handleIntersection(entries) {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const sectionId = entry.target.id;
        const color = sectionColors[sectionId];

        if (color) {
          document.documentElement.style.setProperty('--highlight-color', color);
        }
      }
    });
  }

  // Cr√©e l'observer
  const observer = new IntersectionObserver(handleIntersection, {
    root: document.querySelector('#container-projets'), // horizontal scrolling container
    rootMargin: '0px',
    threshold: 0.6, // 60% visible dans le viewport horizontal
  });

  // Observe chaque section
  sections.forEach(section => observer.observe(section));


//    CARROUSEL INFINI DES IMG

  class VerticalCarousel {
    constructor(trackElement) {
      this.track = trackElement;
      this.slides = Array.from(trackElement.querySelectorAll('.carrousel-slide'));
      this.slideHeight = window.innerHeight - 2 * this.getVh(16.667); // correspond √† .img-principale height
      this.originalSlideCount = this.slides.length / 2; // On suppose qu'on a doubl√© les images
      this.currentIndex = 1; // Start sur la 1√®re "vraie" image
      this.isScrolling = false;
      this.scrollThreshold = 50;
      this.scrollAccumulator = 0;

      this.init();
      this.bindEvents();
    }

    getVh(vh) {
      return window.innerHeight * (vh / 100);
    }

    init() {
      this.track.style.transform = `translateY(-${this.slideHeight}px)`;
      this.updateScrollIndicator();
    }

    bindEvents() {
      const scrollZone = this.track.closest('.carrousel-container').querySelector('.scroll-capture');

      let startY = 0;
      let scrollY = 0;

      // Souris
      scrollZone.addEventListener('wheel', (e) => {
        e.preventDefault();
        console.log('üéØ Scroll d√©tect√©', e.deltaY);
        if (this.isScrolling) return;

        this.scrollAccumulator += e.deltaY;

        if (Math.abs(this.scrollAccumulator) >= this.scrollThreshold) {
          const direction = this.scrollAccumulator > 0 ? 1 : -1;
          this.scrollToSlide(direction);
          this.scrollAccumulator = 0;
        }
      }, { passive: false });

      // Mobile
      scrollZone.addEventListener('touchstart', (e) => {
        startY = e.touches[0].clientY;
        scrollY = 0;
      }, { passive: true });

      scrollZone.addEventListener('touchmove', (e) => {
        e.preventDefault();
        scrollY = e.touches[0].clientY - startY;
      }, { passive: false });

      scrollZone.addEventListener('touchend', () => {
        if (Math.abs(scrollY) > this.scrollThreshold) {
          const direction = scrollY > 0 ? -1 : 1;
          this.scrollToSlide(direction);
        }
      }, { passive: true });
    }

    scrollToSlide(direction) {
      if (this.isScrolling) return;

      this.isScrolling = true;
      this.currentIndex += direction;
      this.track.style.transition = 'transform 0.6s ease';
      this.track.style.transform = `translateY(-${this.currentIndex * this.slideHeight}px)`;

      setTimeout(() => {
        if (this.currentIndex >= this.slides.length - 1) {
          // retour au d√©but
          this.currentIndex = 1;
          this.track.style.transition = 'none';
          this.track.style.transform = `translateY(-${this.currentIndex * this.slideHeight}px)`;
          setTimeout(() => {
            this.track.style.transition = 'transform 0.6s ease';
          }, 50);
        } else if (this.currentIndex <= 0) {
          // retour √† la fin
          this.currentIndex = this.slides.length - 2;
          this.track.style.transition = 'none';
          this.track.style.transform = `translateY(-${this.currentIndex * this.slideHeight}px)`;
          setTimeout(() => {
            this.track.style.transition = 'transform 0.6s ease';
          }, 50);
        }

        this.updateScrollIndicator();
        this.isScrolling = false;
      }, 600);
    }

    updateScrollIndicator() {
      const indicator = this.track.closest('.carrousel-container').querySelector('.scroll-indicator');
      if (!indicator) return;

      let realIndex = this.currentIndex - 1;
      if (realIndex < 0) realIndex = this.originalSlideCount - 1;
      if (realIndex >= this.originalSlideCount) realIndex = 0;

      const progress = (realIndex / (this.originalSlideCount - 1)) * (100 - 20); // 20 = height of ::after
      indicator.style.setProperty('--scroll-progress', `${progress}px`);
    }
  }

  // Lancer tous les carrousels au DOM pr√™t
  document.addEventListener('DOMContentLoaded', () => {
    const tracks = document.querySelectorAll('.carrousel-track');
    tracks.forEach(track => {
      new VerticalCarousel(track);
    });

    // Injecte style pour .scroll-indicator::after
    const style = document.createElement('style');
    style.textContent = `
      .scroll-indicator::after {
        top: var(--scroll-progress, 0px);
      }
    `;
    document.head.appendChild(style);
  });

</script>


</html>